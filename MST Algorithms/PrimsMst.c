#include <stdio.h>
#include <limits.h>
#include <stdbool.h>
#include <time.h>
#define Cap 100 // Maximum on noof vertices
#define maxint INT_MAX

typedef struct Graph
{
	int nfverts;
	int mat[Cap + 1][Cap + 1];
	int mst[Cap];
} Graph;

void g_read(Graph* gr)
{
	scanf("%d", &(gr->nfverts));
	int i, j;

	// Reading the adj mat
	for (i = 1; i <= gr->nfverts; ++i)
	{
		for (j = 1; j <= gr->nfverts; ++j)
		{
			scanf("%d", &(gr->mat[i][j]));
		}
		gr->mat[i][i] = 0; // Removing self loops
	}
}

void g_print(Graph* gr)
{
	int i, j;

	// Printing the adj mat
	for (i = 1; i <= gr->nfverts; ++i)
	{
		for (j = 1; j <= gr->nfverts; ++j)
		{
			printf("%d ", (gr->mat[i][j]));
		}

		printf("\n");
	}
}

int min_key(int nfverts, int* key, bool* visited)
{
	int min = maxint, min_ind;
	for (int v = 1; v <= nfverts; ++v)
	{
		if (key[v] < min && visited[v] == false)
		{	
			min = key[v];
			min_ind = v;
		}
	}
	return min_ind;
}

void g_print_mst(Graph* gr, int src)
{
	int total_cost = 0, i;
	int* mst = gr->mst;

	for (i = 1; i < src; ++i)
	{
//		printf("(%d, %d) ", i, mst[i]);
		total_cost += gr->mat[i][mst[i]];
	}
	for (i = src + 1; i <= gr->nfverts; ++i)
	{
//		printf("(%d, %d) ", i, mst[i]);
		total_cost += gr->mat[i][mst[i]];
	}
//	printf("\n");
	
	printf("Minimum cost by Prim's = %d\n", total_cost);
}

void g_prims_mst(Graph* gr, int src)
{
	int key[gr->nfverts + 1];
	bool visited[gr->nfverts + 1];
	int* mst = gr->mst;

	int i;
	for (i = 1; i <= gr->nfverts; ++i)
	{
		key[i] = maxint;
		visited[i] = false;
	} 
	
	key[src] = 0; // so that vertex 0 is picked first
	
	mst[src] = -1; // src node is root
	int u, v;
		
	#define cost(u, v) (gr->mat[u][v])
	
	for (i = 1; i <= gr->nfverts; ++i)
	{
		u = min_key(gr->nfverts, key, visited);
		visited[u] = true;
				
		for (v = 1; v <= gr->nfverts; ++v)
		{
			if (cost(u, v) > 0 && visited[v] == false && key[v] > cost(u, v))
			{
				key[v] = cost(u, v);
				mst[v] = u;
			}
		}
	}
}

void main()
{
	Graph gr;
	g_read(&gr);
	int src = 1;
	g_prims_mst(&gr, src); // Fills in mst
	g_print_mst(&gr, src);
}

/*
Tests

TESTS

#1
In: 6
0 4 0 0 6 5
4 0 1 0 0 4
0 1 0 6 0 4
0 0 6 0 8 5
6 0 0 8 0 2
5 4 4 5 2 0

Out:
{(1, 0), (2, 1), (3, 5), (4, 5), (5, 1), }
16

#2
In: 7
00 00 14 00 18 24 00
00 00 28 00 00 00 10
14 28 00 16 00 00 00
00 00 16 00 12 00 00
18 00 00 12 00 22 00
24 00 00 00 22 00 25
00 10 00 00 00 25 00

Out:
{(1, 6), (2, 0), (3, 2), (4, 3), (5, 4), (6, 5), }
99

#3
In: 10
0 90 0 96 31 0 8 0 74 88 
0 34 74 0 94 0 0 56 0 68 
0 0 45 79 42 47 20 29 0 0 
0 0 19 17 0 93 83 0 37 5 
0 26 7 0 83 0 0 94 0 19 
70 0 0 0 0 0 13 44 0 90 
59 0 71 0 37 83 0 20 57 0 
22 0 100 0 11 0 0 0 90 79 
0 0 99 47 27 0 88 0 0 67 
0 0 42 70 21 0 0 95 0 48 
 Out: {...} 435


 
#4
In: 50
0 0 21 0 19 98 0 40 0 0 0 0 0 0 0 0 57 0 87 0 0 32 12 0 83 0 0 0 0 40 0 25 24 0 0 0 0 0 0 0 2 0 0 0 0 0 0 49 90 93 
36 0 43 0 15 0 0 60 0 0 0 98 0 0 0 0 0 0 0 67 59 0 0 15 79 0 37 0 0 30 0 0 0 0 0 0 0 0 0 0 91 0 0 0 24 0 0 31 0 26 
79 0 0 0 48 0 60 0 0 92 69 0 0 0 0 9 91 100 0 0 0 0 22 0 43 31 0 69 0 0 0 0 0 0 61 0 54 87 39 68 0 0 0 0 58 52 0 57 26 10 
0 61 0 64 0 46 0 0 0 29 0 0 44 13 0 80 0 89 0 0 2 0 0 42 91 0 77 0 0 96 0 40 36 0 0 0 0 53 0 34 0 17 18 0 0 0 0 0 0 0 
0 0 0 0 0 0 10 0 0 0 66 0 0 0 0 0 80 74 0 96 0 0 0 0 77 46 0 65 0 0 0 0 66 0 6 0 21 0 0 0 0 0 70 0 96 0 0 33 0 0 
0 32 26 5 0 0 7 34 0 0 2 64 0 64 47 0 25 0 0 0 0 0 0 90 0 0 0 10 0 0 0 64 59 50 0 57 0 78 0 0 0 0 12 43 0 0 0 0 25 38 
74 0 0 36 44 6 0 72 21 0 34 0 63 0 0 40 0 0 0 0 0 0 14 58 55 0 17 0 6 0 0 57 0 0 12 0 0 84 0 0 0 0 0 52 20 31 0 0 43 0 
0 0 0 0 90 5 0 0 0 0 0 35 0 81 0 63 0 56 0 0 0 0 0 9 0 98 27 0 0 38 6 64 0 0 0 63 100 0 11 0 0 0 0 0 0 0 0 0 0 29 
0 21 89 0 0 0 68 0 62 0 67 0 0 35 25 0 18 0 0 0 32 22 20 64 0 0 87 0 0 0 0 9 0 85 0 76 0 33 0 0 0 0 0 41 0 0 12 0 0 0 
92 82 16 0 0 0 0 0 0 0 37 0 0 33 7 0 8 7 59 10 0 0 0 0 0 53 0 0 0 0 0 62 76 0 0 0 31 0 0 0 0 0 44 8 33 44 23 0 8 0 
0 8 28 0 49 85 0 88 10 0 0 46 87 0 0 0 33 0 0 0 0 31 0 0 0 0 0 38 0 19 5 39 82 0 0 5 0 0 0 91 0 0 59 37 0 22 18 0 0 0 
70 0 77 0 0 0 49 0 40 0 0 0 44 0 0 0 0 31 0 0 95 91 0 0 0 0 0 0 8 0 30 86 0 0 0 49 0 0 0 1 0 76 0 38 0 46 0 0 0 0 
0 33 0 19 0 0 0 9 0 91 0 0 0 0 65 0 99 0 69 0 0 54 27 23 79 0 0 0 0 76 75 0 66 0 0 11 0 0 0 45 0 0 2 15 0 7 0 80 0 0 
0 0 55 71 0 20 0 0 0 0 0 0 38 23 75 0 0 90 30 0 0 0 0 0 12 0 0 66 19 0 22 54 0 90 30 0 40 0 0 0 0 70 0 0 0 20 0 0 5 0 
7 0 0 0 0 65 24 0 13 0 66 0 95 0 0 72 9 84 64 29 87 0 0 0 94 0 0 0 33 0 0 33 80 5 0 72 0 0 16 0 0 0 0 37 0 88 0 37 2 0 
87 9 0 95 37 91 83 0 0 1 0 0 0 0 0 0 65 30 0 0 0 36 28 8 0 16 19 41 0 63 28 0 0 0 34 0 27 0 0 0 0 17 0 23 0 98 0 0 0 0 
12 0 94 0 0 40 7 36 0 93 20 0 21 0 1 88 0 0 0 89 0 0 52 2 0 0 0 58 0 17 92 0 40 63 97 88 0 36 0 0 0 0 32 0 0 80 0 0 0 94 
0 67 0 93 0 0 60 0 0 0 0 0 62 0 0 58 0 0 0 31 0 49 36 0 0 90 0 63 0 0 0 96 0 0 41 77 27 0 90 81 0 0 86 0 0 0 65 0 0 0 
0 0 78 31 94 0 0 0 0 0 0 0 0 0 0 79 0 0 0 0 0 0 32 0 0 37 18 0 0 86 16 94 22 0 0 61 0 0 19 0 0 29 11 74 57 46 66 0 0 0 
37 30 81 26 0 0 0 0 16 0 0 65 0 48 0 0 0 0 0 11 0 0 18 0 0 0 0 6 0 0 41 0 45 0 0 0 0 72 0 43 0 72 0 81 42 13 0 96 0 47 
0 0 0 10 62 68 0 0 0 37 35 50 36 37 74 0 12 0 0 0 0 89 0 0 0 0 0 44 6 0 0 84 38 0 71 0 0 0 99 0 0 0 0 63 15 86 0 73 0 97 
45 73 0 0 0 0 0 0 0 0 0 0 0 71 46 0 0 0 0 0 0 0 0 36 0 0 0 0 0 94 30 0 55 0 0 33 0 0 14 16 0 64 0 0 75 35 0 38 31 0 
0 89 0 0 58 9 40 0 0 0 79 0 0 6 0 0 0 0 0 0 71 100 0 0 76 33 0 0 0 0 0 0 0 0 57 0 42 0 0 23 66 0 0 0 83 70 0 25 0 41 
56 59 0 15 0 83 17 0 0 0 0 13 0 6 77 0 0 92 11 0 32 0 71 0 0 0 45 0 70 0 0 46 0 0 0 15 0 0 0 27 0 0 50 0 0 0 43 0 88 9 
0 47 21 0 0 0 76 0 0 0 0 79 18 15 0 0 0 0 23 0 0 0 43 34 0 0 0 0 0 0 47 0 65 85 0 0 60 49 0 0 16 0 67 0 7 96 88 0 0 16 
74 0 1 0 64 0 0 0 20 9 0 0 99 41 0 0 0 0 47 0 0 24 67 0 40 98 58 43 0 0 81 0 0 0 40 49 62 0 0 63 0 0 0 87 0 4 0 45 0 44 
0 100 0 0 0 0 0 0 0 0 0 0 0 0 0 0 39 0 0 40 0 62 0 0 1 69 0 85 0 36 0 71 0 73 53 34 57 86 0 0 80 60 0 0 0 0 0 0 0 0 
0 8 73 0 0 0 0 0 0 68 45 0 32 41 0 0 0 0 0 0 0 0 53 0 85 0 91 0 0 0 0 0 0 58 0 65 0 0 0 0 0 5 0 40 0 47 73 85 50 82 
63 0 0 0 17 0 0 98 0 0 0 0 0 15 0 0 0 0 0 49 0 3 0 0 52 57 38 0 0 17 54 85 0 90 100 81 49 0 87 0 0 52 0 0 0 24 8 0 0 0 
28 14 0 85 0 0 2 0 0 0 0 96 56 0 0 0 92 0 67 0 0 9 74 99 58 44 88 0 0 14 0 13 0 0 0 84 0 0 91 31 7 95 0 33 51 75 0 0 44 0 
0 0 65 29 0 0 0 0 42 45 11 33 0 0 0 31 26 0 0 0 0 0 35 0 0 65 70 0 0 0 0 0 0 0 81 33 0 0 0 0 89 64 0 38 0 73 0 0 0 92 
36 68 0 87 0 0 0 0 0 0 0 9 80 0 0 0 0 0 0 0 0 74 41 0 63 7 0 0 0 0 0 0 95 0 0 72 0 0 0 0 0 0 0 0 0 40 0 25 10 82 
0 0 0 63 0 0 81 2 0 0 94 64 0 0 65 0 0 45 89 0 26 44 36 0 8 0 0 14 0 0 0 23 0 75 0 0 0 92 75 0 5 0 0 68 72 97 28 0 0 86 
97 87 0 17 0 0 0 0 0 66 0 0 46 71 0 0 0 56 0 0 0 0 5 0 0 0 0 42 0 58 77 0 77 0 0 0 0 0 0 0 0 0 77 68 3 87 45 0 33 0 
0 0 52 0 0 0 0 0 0 0 85 71 6 0 0 0 46 0 0 0 0 0 0 0 0 0 0 0 70 0 0 0 0 0 0 0 0 0 99 27 50 63 0 0 0 2 97 98 0 0 
52 0 80 0 0 0 0 45 47 0 0 0 41 0 0 74 0 0 0 0 0 78 0 0 0 0 0 0 3 0 75 0 60 0 6 0 0 0 0 0 0 69 0 0 0 0 0 0 84 0 
99 0 70 79 44 0 86 0 80 0 55 0 0 0 0 0 0 0 0 0 20 97 0 6 31 0 0 0 50 0 79 0 43 43 0 0 0 0 90 0 0 0 0 6 91 0 0 0 0 0 
0 59 58 17 55 0 89 24 0 0 0 0 33 76 52 0 0 29 78 40 0 45 0 0 0 0 54 0 66 42 96 0 0 0 50 0 0 0 0 41 0 67 0 0 0 76 0 0 0 0 
74 0 92 0 40 0 0 96 91 28 0 0 16 0 59 0 19 0 0 5 0 0 0 0 0 28 67 0 57 0 0 0 0 0 4 0 84 0 58 0 1 3 0 0 0 0 0 99 75 66 
15 0 0 0 0 84 0 47 32 0 0 0 0 0 73 13 0 0 0 0 0 0 57 0 0 0 0 28 0 0 30 45 0 80 26 78 51 45 64 40 0 0 69 0 0 54 0 0 0 6 
0 72 0 0 19 0 0 0 0 0 0 0 0 0 0 35 57 100 32 55 0 77 0 0 0 2 0 78 0 0 44 0 0 0 14 62 0 27 0 0 0 0 0 43 0 0 0 65 0 0 
0 0 0 8 0 15 0 0 82 0 0 0 0 77 0 48 0 0 32 0 100 1 0 0 0 77 71 9 0 64 0 30 0 0 6 0 0 0 0 0 0 11 24 52 0 38 0 0 45 0 
0 0 0 0 75 0 0 82 58 0 0 0 35 52 0 0 0 0 0 0 35 0 25 71 0 0 0 0 0 97 31 34 0 0 1 0 0 0 42 0 0 0 31 0 76 0 0 0 0 8 
66 66 0 9 0 83 88 0 73 0 0 0 0 34 0 78 0 0 28 0 0 26 0 56 0 49 0 0 0 5 0 48 60 0 0 0 49 0 0 0 0 0 0 0 81 33 10 4 0 2 
0 0 75 33 0 0 50 0 24 0 63 0 0 0 58 2 38 0 0 91 67 23 45 17 0 0 0 0 0 83 29 75 83 0 0 0 0 83 0 0 0 75 52 0 0 0 35 5 0 93 
61 0 0 0 48 12 0 32 92 0 0 27 0 37 0 0 0 19 0 0 0 0 75 0 38 0 86 95 16 77 0 0 0 0 0 89 0 79 21 0 0 78 0 0 44 46 16 13 0 0 
0 0 0 19 0 1 78 0 57 0 7 0 0 68 99 0 24 20 0 59 0 4 0 89 49 0 97 49 0 30 86 3 85 0 49 0 0 0 9 0 4 0 0 47 0 0 48 39 81 0 
18 0 43 10 0 0 0 0 0 0 0 0 0 0 0 0 83 0 0 31 0 0 0 42 41 27 51 0 53 82 0 37 0 0 28 0 0 0 0 0 39 0 31 0 0 21 0 0 0 0 
0 0 37 0 0 0 0 30 74 81 0 92 0 0 0 0 52 9 29 0 0 0 38 15 42 0 0 0 0 58 0 0 22 0 0 0 27 0 58 0 0 0 0 0 74 36 81 20 0 64 
87 64 95 86 95 60 0 0 0 20 66 0 0 27 38 0 0 0 70 0 0 78 0 18 0 41 0 0 0 0 0 2 0 0 49 0 0 65 0 0 0 0 41 0 0 68 86 0 36 0
Out: 779

#5
In: 10
2 64 18 55 56 76 77 92 42 2 
19 47 32 95 50 41 61 27 83 65 
84 69 49 73 29 46 51 22 84 14 
76 36 39 31 34 95 99 91 26 65 
49 19 19 98 76 74 65 54 27 22 
27 96 14 54 36 4 27 22 67 92 
14 81 57 95 96 51 66 96 84 96 
36 61 35 37 59 61 7 15 48 44 
16 42 96 61 48 50 85 74 52 15 
33 91 88 96 18 58 44 87 51 91
Out:
555


*/

